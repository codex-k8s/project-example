# Page 10 — Чек-листы и Definition of Done

## Зачем
Сделать применение стандарта “по умолчанию” и снизить субъективность ревью.

---

## Self-check разработчика (перед PR)
Архитектура:
- понимаю, где граница сервиса для HTTP и где для gRPC?
- слои не смешаны?

Ошибки:
- ошибки возвращаются наверх, не “прячутся” без причины?
- при добавлении контекста использую `%w`?
- нет сравнения по `err.Error()`?
- нет panic для ожидаемых сценариев?

Typed errors:
- typed error использован только когда нужен?
- типы централизованы и их мало?
- typed error не содержит транспортных кодов?

Слои:
- client/repo/service не логируют ошибки?
- business validation в service/use-case, а не в handler?

HTTP (если есть):
- OpenAPI/schema validation не дублируется в handler?
- есть единый HTTP error boundary?
- нет утечки внутренних деталей в prod?

gRPC (если есть):
- настроены interceptors: recovery + error mapping?
- доменные ошибки маппятся в правильные `codes.*`?
- нет “всё превращается в Unknown/Internal” без причины?

Параллельность (если есть):
- есть fan-in (errgroup/явная агрегация)?
- panic в goroutine перехватывается?
- логирование только после агрегации?

---

## Чек-лист ревьюера
Границы:
- нет маппинга HTTP/gRPC кодов в service/repo?
- transport handlers тонкие?

Логи:
- нет логирования ниже границы?
- `context.Canceled` не логируется как ошибка?

Контракт:
- формат ошибок в HTTP стабилен и безопасен?
- в gRPC коды соответствуют семантике?

Typed errors:
- нет “зоопарка”?
- нет sentinel-ошибок с данными в строке?

Исключения:
- если исключение используется, оно подпадает под Page 8?
- временные исключения ограничены флагом и сроком?

---

## DoD: “сервис соответствует стандарту”, если
База:
- нет универсальных AppError-структур
- логирование ошибок только на границе
- `%w` используется осмысленно
- typed errors минимальны и централизованы

HTTP (если применимо):
- OpenAPI/schema validation в middleware
- единый error handler/boundary
- в prod не выдаём внутренние детали

gRPC (если применимо):
- recovery interceptor включён
- есть централизованный маппинг доменных ошибок в `codes.*`
- ожидаемые ошибки не спамят логами

Параллельность:
- fan-in для параллельных задач
- panic не приводит к silent crash
- одна точка логирования итоговой ошибки
