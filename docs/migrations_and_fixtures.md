# Миграции и фикстуры

## Django (схема БД)

Все миграции находятся в `services/django_backend/chat/migrations`.

Текущая начальная миграция:

- создаёт таблицы `chat_user` и `chat_message`.

### Добавление новых полей/таблиц

1. Измените модели в `services/django_backend/chat/models.py`.
2. В dev‑окружении (через `kubectl exec` в Pod Django
   или локально) выполните:

   ```bash
   python manage.py makemigrations chat
   python manage.py migrate
   ```

3. Зафиксируйте созданные файлы миграций в Git.
4. Убедитесь, что Go‑сервисы, которые работают с БД,
   используют актуальные поля и таблицы.

В Kubernetes‑деплое миграции также выполняются в init‑контейнере
`django-backend-migrate` (см. `services/django_backend/deploy.yaml`),
чтобы стейджинг и AI‑слоты были на актуальной схеме.

## Фикстуры

В данном примере проекте фикстуры не используются.
Если они понадобятся:

- храните их в `services/django_backend/chat/fixtures/*.json`;
- загружайте при необходимости командой:

  ```bash
  python manage.py loaddata <fixture_name>.json
  ```

### Рекомендации

- Используйте фикстуры только для небольших наборов данных
  (например, тестовые пользователи, сообщения);
- для больших наборов / производственных сценариев
  предпочтительнее писать миграции или отдельные скрипты заполнения.

