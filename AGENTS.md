# AGENTS Requirements and Guidelines

- комментарии в коде только на английском (ты НЕ должен писать комментарии такого содержания: `все комментарии на английском, тексты ошибок/логов — на английском` или `ошибка на английском`, просто следуй инструкциям и комментируй код с использованием английского языка!)
- ответы в консоли только на русском
- тексты ошибок и записи в лог только на английском
- правила наблюдаемости (где пишем логи/метрики/трейсы и как прокидываем trace_id/span_id) см. `docs/observability.md`
- при добавлении переиспользуемой логики обязательно см. `docs/libs.md` и выноси её в библиотеку по примеру `libs/go/metrics`
- **ТЫ ДОЛЖЕН УЧИТЫВАТЬ** общее описание проекта в файле `./README.md`
- **ТЫ ДОЛЖЕН УЧИТЫВАТЬ** документацию в файлах `./docs/*.md`
- после правок моделей синхронизируй `docs/models.md`
- после создания новых папок и файлов ВНЕ папок сервисов, синхронизируй структуру и описание в `docs/architecture_project.md`
- после создания новых пакетов в микросервисах на Go синхронизируй пример в `docs/go_services.md`
- если нужны зависимости которых ранее не было, то устанавливай их, у тебя есть доступ в сеть к любым ресурсам с методами GET, HEAD и OPTIONS.
- коммиты не делай, я сам их сделаю, **кроме автоматических запусков Codex через codexctl в Kubernetes‑окружении** — в этих флоу ты должен сам делать `git add/commit/push` в ветки `codex/issue-*` и обновлять PR
- предполагается, что при твоей работе все сервисы запущены в Kubernetes‑кластере (локальном dev или dev‑ai/стейджинг через codexctl), и ты проверяешь правки через `kubectl` (логи, статусы Pod/Deployment, exec в контейнеры).
- про деплой и сборку образов читай в `docs/deploy.md` и конфигурацию `services.yaml` (он используется `codexctl` и GitHub‑раннерами для dev/ai/staging‑окружений).
- если добавлен новый сервис, синхронизируй `services.yaml` (разделы `images`, `services`, при необходимости `infrastructure`) и проверь, что dev/ai‑оверлеи корректно монтируют исходники и библиотеки; при изменении состава сервисов проверь, не требуется ли обновление GitHub‑workflow’ов.
- каждый сервис в dev/dev‑ai окружениях работает с монтированными исходниками; после правок подожди несколько секунд и проверь логи нужного Pod’а через `kubectl logs`, чтобы убедиться, что изменения подхватились.
- если изменения подразумевают работу с БД или Redis, то после правок проверяй работу нового кода через чтение БД и Redis с помощью `kubectl port-forward` и инструментов `psql` и `redis-cli` (либо выполняя команды в подах БД/Redis). Секреты для подключения доступны тебе в переменных окружения, которые перечислены в `deploy/secret.yaml` (для dev-ai окружения ты развернут в поде манифестом `deploy/codex/codex-deploy.yaml`).
- если загружаешь какие-либо зависимости для себя, то делай это в папку `.cache`, т.к. она в `.gitignore` и не попадет в репозиторий.
- перед добавлением новых зависимостей или реализацией функционала, примеров которого в коде или промпте нет, ОБЯЗАТЕЛЬНО ищи актуальную информацию в context7 (доступен тебе по MCP), для этого тебе доступны инструменты (функции): get-library-docs, resolve-library-id.
- мы в активной стадии разработки, поэтому если что-то по моим инструкциям меняешь или удаляешь, то не надо писать об этом комментарии в коде, просто актуализируй код и документацию. Обратную совместимость поддерживать не нужно, у нас нет кода в продакшене.
- по вопросам миграций и фикстур смотри `docs/migrations_and_fixtures.md`.
- если ты работаешь в облачном dev‑ai окружении (слоты, создаваемые через `codexctl ci ensure-slot/ensure-ready` и GitHub‑workflow’ы), помни, что агент запускается в отдельном Pod’е `codex` в namespace слота. Для кода, зависящего от окружения конкретного сервиса (библиотеки, CLI, локальные сокеты и т.п.), предпочитай выполнять команды внутри Pod’ов соответствующих сервисов (`kubectl exec`), а не внутри Pod’а агента.
- при работе в dev‑ai окружении обращения к внутренним сервисам выполняй по внутренним DNS‑именам Kubernetes, как они описаны в `services/*/deploy.yaml` для сервисов приложения и в `deploy/*.yaml` для инфраструктурных компонентов (Postgres, Redis, RabbitMQ и т.п.).
- в процессе работы ты НЕ ДОЛЖЕН давать ответы в стиле "я не успеваю завершить задачу" или "задача слишком объемная". Если задача поставлена — выполняй её строго в соответствии с запросом.
