apiVersion: v1
kind: Secret
metadata:
  name: crypto-secret
  namespace: {{ .Namespace }}
type: Opaque
stringData:
  SECRET_KEY: '{{ envOr "SECRET_KEY" "" }}'
---
apiVersion: v1
kind: Secret
metadata:
  name: db-secret
  namespace: {{ .Namespace }}
type: Opaque
stringData:
  # Админ/owner PostgreSQL (используется самим postgres и initContainers для создания БД/ролей).
  POSTGRES_USER: '{{ envOr "POSTGRES_USER" "" }}'
  POSTGRES_PASSWORD: '{{ envOr "POSTGRES_PASSWORD" "" }}'

  # Сервисные креды (изолированные) — используются приложениями и миграциями.
  USERS_POSTGRES_USER: '{{ envOr "USERS_POSTGRES_USER" "" }}'
  USERS_POSTGRES_PASSWORD: '{{ envOr "USERS_POSTGRES_PASSWORD" "" }}'
  MESSAGES_POSTGRES_USER: '{{ envOr "MESSAGES_POSTGRES_USER" "" }}'
  MESSAGES_POSTGRES_PASSWORD: '{{ envOr "MESSAGES_POSTGRES_PASSWORD" "" }}'
---
apiVersion: v1
kind: Secret
metadata:
  name: redis-secret
  namespace: {{ .Namespace }}
type: Opaque
stringData:
  # Пароль Redis сервера (requirepass). Клиентские пароли должны совпадать с ним.
  REDIS_PASSWORD: '{{ envOr "REDIS_PASSWORD" "redis" }}'
  CHAT_GATEWAY_REDIS_PASSWORD: '{{ envOr "CHAT_GATEWAY_REDIS_PASSWORD" (envOr "REDIS_PASSWORD" "redis") }}'
---
apiVersion: v1
kind: Secret
metadata:
  name: openai-secret
  namespace: {{ .Namespace }}
type: Opaque
stringData:
  OPENAI_API_KEY: '{{ envOr "OPENAI_API_KEY" "" }}'
---
apiVersion: v1
kind: Secret
metadata:
  name: context7-secret
  namespace: {{ .Namespace }}
type: Opaque
stringData:
  CONTEXT7_API_KEY: '{{ envOr "CONTEXT7_API_KEY" "" }}'
---
apiVersion: v1
kind: Secret
metadata:
  name: github-secret
  namespace: {{ .Namespace }}
type: Opaque
stringData:
  CODEXCTL_GH_PAT: '{{ envOr "CODEXCTL_GH_PAT" "" }}'
